df5 <- df %>% mutate() %>% group_by(month(Date)) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`))
head(df5)
View(df5)
View(df5)
liquor <- dat%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`)/1000)) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(dplyr)
liquor <- dat%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`)/1000)) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(dplyr)
liquor <- dat%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(lubridate)
library(tidyverse)
library(tidyr)
#install.packages("csvread")
dat <- readr::read_csv('2021_Iowa_Liquor_Sales.csv')
dat$Date <- mdy(dat$Date)
dat <- separate(dat,`Store Location`, into= c("DONT SAVE", "Latitude", "Longitude"), sep=' ')
dat <- separate(dat, 'Latitude', into= c("DONT SAVE 1","Latitude"), sep='\\(')
dat <- separate(dat, 'Longitude', into= c("Logitude","DONT SAVE 2"), sep='\\)')
df <- dat[-c(8,9,12)]
head(df)
library(ggplot2)
library(dplyr)
liquor <- dat%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(dplyr)
df5 <- df
df5 <- df %>% mutate() %>% group_by(month(Date)) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`))
head(df5)
df4 <- dat
df4$day <- weekday(Date)
df4 <- dat
df4$day <- weekdays(Date)
library(tidyverse)
df4 <- dat
df4$day <- weekdays(Date)
library(tidyverse)
df4 <- dat
df4$day <- weekdays(df4$Date)
head(df4)
library(lubridate)
library(tidyverse)
library(tidyr)
#install.packages("csvread")
dat <- readr::read_csv('2021_Iowa_Liquor_Sales.csv')
dat$Date <- mdy(dat$Date)
dat <- separate(dat,`Store Location`, into= c("DONT SAVE", "Latitude", "Longitude"), sep=' ')
dat <- separate(dat, 'Latitude', into= c("DONT SAVE 1","Latitude"), sep='\\(')
dat <- separate(dat, 'Longitude', into= c("Logitude","DONT SAVE 2"), sep='\\)')
df <- dat[-c(8,9,12)]
head(df)
library(ggplot2)
library(dplyr)
liquor <- dat%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(tidyverse)
df4 <- dat
df4$day <- weekdays(df4$Date)
head(df4)
df5 <- df
df5 <- df %>% mutate() %>% group_by(month(Date)) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`))
head(df5)
library(ggplot2)
library(dplyr)
liquor <- df%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(tidyverse)
df4 <- df
df4$day <- weekdays(df4$Date)
head(df4)
library(tidyverse)
df4 <- df
df4$day <- weekdays(df4$Date)
head(df4)
weekday <- df4%>%group_by(`day`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
View(weekday)
View(df4)
library(ggplot2)
library(dplyr)
liquor <- df%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(tidyverse)
df4 <- df
df4$day <- weekdays(df4$Date)
head(df4)
weekday <- df4%>%group_by(`day`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p4 <- ggplot(weekday, aes(x = reorder(`day`,-total),y = `total`,fill = `day`)) +
geom_bar(stat= 'identity') +xlab("Day of the Week")+ggtitle("Liquor sales by day") +ylab("Total Sales")
p4 +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(tidyverse)
df4 <- df
df4$day <- weekdays(df4$Date)
head(df4)
weekday <- df4%>%group_by(`day`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p4 <- ggplot(weekday, aes(x = reorder(`day`,-total),y = `total`,fill = `day`)) +
geom_bar(stat= 'identity') +xlab("Day of the Week")+ggtitle("Liquor sales by day") +ylab("Total Sales")
p4 +theme(axis.text.x = element_text(angle = 45, hjust = 1))
df5 <- df
df5$month <- month(df5$Date)
#df5 <- df %>% mutate() %>% group_by(month(Date)) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`))
head(df5)
View(df5)
View(df5)
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`))
head(liq_month)
View(weekday)
View(weekday)
View(liq_month)
View(df4)
View(df4)
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`)) %>% arrage(desc(total))
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`)) %>% arrange(desc(total))
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month, df5$`Category Name`) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
View(df5)
library(lubridate)
library(tidyverse)
library(tidyr)
#install.packages("csvread")
dat <- readr::read_csv('2021_Iowa_Liquor_Sales.csv')
dat$Date <- mdy(dat$Date)
dat <- separate(dat,`Store Location`, into= c("DONT SAVE", "Latitude", "Longitude"), sep=' ')
dat <- separate(dat, 'Latitude', into= c("DONT SAVE 1","Latitude"), sep='\\(')
dat <- separate(dat, 'Longitude', into= c("Logitude","DONT SAVE 2"), sep='\\)')
df <- dat[-c(8,9,12)]
head(df)
library(ggplot2)
library(dplyr)
liquor <- df%>%group_by(`Category Name`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p<- ggplot(liquor[1:10,],aes(x = reorder(`Category Name`,-total),y = `total`,fill = `Category Name`)) +
geom_bar(stat= 'identity') +xlab("Liquor Name")+ggtitle("Top 10 best selling liquor") +ylab("Total Sales")
p +scale_x_discrete(labels = abbreviate) +theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(tidyverse)
df4 <- df
df4$day <- weekdays(df4$Date)
head(df4)
weekday <- df4%>%group_by(`day`) %>% summarize(total= (sum(`Volume Sold (Liters)`))) %>% arrange(desc(total))
p4 <- ggplot(weekday, aes(x = reorder(`day`,-total),y = `total`,fill = `day`)) +
geom_bar(stat= 'identity') +xlab("Day of the Week")+ggtitle("Liquor sales by day") +ylab("Total Sales")
p4 +theme(axis.text.x = element_text(angle = 45, hjust = 1))
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(df5$`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
View(liq_month)
View(liq_month)
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month) + geom_line(aes(x = month, y = `Category Name`))
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month) + geom_line(aes(x = month, y = `Category Name`))
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month), y = totalVolume) + geom_line(aes(x = month, y = `Category Name`))
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month), y = totalVolume) + geom_line()
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month), y = totalVolume) + geom_line(group = `Category Name`)
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month), y = totalVolume) + geom_line(group = 'Category Name')
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month), y = totalVolume) + geom_line(aes(x=month, y = totalVolume) ,group = 'Category Name')
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month), y = totalVolume) + geom_line(aes(x=month, y = totalVolume, group = 'Category Name'))
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month, y = totalVolume)) + geom_line(aes(x=month, y = totalVolume, group = 'Category Name'))
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month, y = totalVolume)) + geom_line(aes(x=month, y = totalVolume, group = liq_month$`Category Name`))
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month[1:10,], aes(x= month, y = totalVolume)) + geom_line(aes(x=month, y = totalVolume, group = liq_month$`Category Name`))
p5
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month[1:10], aes(x= month, y = totalVolume)) + geom_line(aes(x=month, y = totalVolume, group = liq_month$`Category Name`))
df5 <- df
df5$month <- month(df5$Date)
liq_month <- df5 %>% group_by(month,`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(liq_month)
p5 = ggplot(liq_month, aes(x= month, y = totalVolume)) + geom_line(aes(x=month, y = totalVolume, group = liq_month$`Category Name`))
p5
df6 <- df5[df5$month %in% c(3:5)]
df6 <- df5[,df5$month %in% c(3:5)]
df6 <- df5[df5$month %in% c(3:5)]
df6 <- subset(df5, df5$month %in% c(3,4,5))
head(df6)
df6 <- subset(df5, df5$month %in% c(3,4,5))
spring_liq <- df6 %>% group_by(df6$`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(spring_liq)
df6 <- subset(df5, df5$month %in% c(3,4,5))
spring_liq <- df6 %>% group_by(df6$`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
spring_liq[1:5]
df6 <- subset(df5, df5$month %in% c(3,4,5))
spring_liq <- df6 %>% group_by(df6$`Category Name`) %>% summarise(totalVolume = sum(`Volume Sold (Gallons)`)) %>% arrange(desc(totalVolume))
head(spring_liq)
View(spring_liq)
View(spring_liq)
source("~/.active-rstudio-document", echo=TRUE)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(stringr)
library(lubridate)
library(scales)
library(readxl)
#import csv files
acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
person <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
fatal <- person %>% filter(INJ_SEV == 4)
danger <- fatal %>% group_by(STATE, MAKE) %>%
summarise(numfatal = n())
danger <- danger %>% na.omit() %>%
group_by(STATE) %>%
filter(numfatal == max(numfatal))
GLCs <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
joinedTables <- inner_join(person, acc, by="ST_CASE")
tallied <- joinedTables %>%
filter(SEX == 1 || SEX == 2) %>%
group_by(ST_CASE) %>%
summarise(avgSex = mean(SEX))
tallied$sexStr <- ifelse(tallied$avgSex == 1, 'Men', ifelse(tallied$avgSex == 2, 'Women', 'Both'))
accident <- tallied %>%
select(ST_CASE, sexStr) %>%
inner_join(acc, by='ST_CASE')
grouped <- accident %>%
filter(HOUR <= 24) %>%
filter(DAY_WEEK != 9) %>%
group_by(sexStr, HOUR, DAY_WEEK) %>%
summarise(numAccidents = n()) %>%
arrange(desc(numAccidents))
ggplot(grouped,aes(x=HOUR, y=numAccidents)) +
geom_bar(stat='identity') +
facet_grid(sexStr~DAY_WEEK) +
xlab("Hours of the day") +
ylab("Total number of accidents")
df <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
person <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
library(ggplot2)
library(tidyverse)
library(lubridate)
fatalities <- person %>% filter(INJ_SEV==4)
head(fatalities,5)
dangerVehicles <- fatalities %>% group_by(MAKE) %>% summarise(fatalities = n())
dangerVehicles
GLC <- readxl::read_xlsx("GLC.xlsx")
GLC <- readxl::read_xlsx("GLC.xlsx")
GLC <- GLC %>% rename(STATE="State Code")
GLC <- GLC %>% rename(NAME="State Name")
GLC$STATE <- as.integer(GLC$STATE)
sf <- fatalities %>% select(STATE,MAKE) %>% drop_na(MAKE)
state <- GLC %>% group_by(STATE,NAME) %>% distinct(STATE,NAME)
sfs <- state %>% inner_join(sf)
smf <- sfs %>% group_by(NAME,MAKE) %>% summarise(deaths=n()) %>%
top_n(1, deaths)
states <- map_data("state")
snames <- data.frame(region=tolower(state.name), long=state.center$x, lat=state.center$y)
smf <- smf %>% mutate(region = tolower(NAME)) %>% inner_join(snames)
states %>% ggplot(aes(x = long, y = lat)) +
geom_path(aes(group = group)) +
coord_map() +
geom_text(data=smf, aes(long, lat, label=MAKE))
GLC <- readxl::read_xlsx("GLC.xlsx")
GLC <- GLC %>% rename(STATE="State Code")
GLC <- GLC %>% rename(NAME="State Name")
GLC$STATE <- as.integer(GLC$STATE)
sf <- fatalities %>% select(STATE,MAKE) %>% drop_na(MAKE)
state <- GLC %>% group_by(STATE,NAME) %>% distinct(STATE,NAME)
sfs <- state %>% inner_join(sf)
smf <- sfs %>% group_by(NAME,MAKE) %>% summarise(deaths=n()) %>%
top_n(1, deaths)
states <- map_data("state")
snames <- data.frame(region=tolower(state.name), long=state.center$x, lat=state.center$y)
smf <- smf %>% mutate(region = tolower(NAME)) %>% inner_join(snames)
states %>% ggplot(aes(x = long, y = lat)) +
geom_path(aes(group = group)) +
coord_map() +
geom_text(data=smf, aes(long, lat, label=MAKE))
pacc <- person %>% inner_join(acc,by=c("STATE","COUNTY","DAY","MONTH","HOUR","MINUTE"))
pacc %>% group_by(DAY_WEEK) %>% summarise(num_accidents=n()) %>% mutate(day_of_week  = wday(DAY_WEEK, label = TRUE)) %>%
ggplot(aes(x=day_of_week,y=num_accidents)) + geom_bar(stat = "Identity")
pacc %>% group_by(HOUR) %>% filter(HOUR<25) %>% summarise(num_accidents=n()) %>%
ggplot(aes(x=HOUR,y=num_accidents)) + geom_bar(stat = "Identity")
paccF <- pacc %>%  filter(SEX<3)
paccF %>% mutate(sn = ifelse(paccF$SEX == 1, "male", "female")) %>% group_by(sn)  %>% summarise(num_accidents=n()) %>%
ggplot(aes(x=sn,y=num_accidents)) + geom_bar(stat = "Identity")
GLC <- GLC %>% rename(COUNTY="County Code")
GLC <- GLC %>% rename(CN="County Name")
GLC$COUNTY <- as.integer(GLC$COUNTY)
cf <- fatalities %>% select(COUNTY) %>% drop_na(COUNTY)
county <- GLC %>% group_by(COUNTY,CN) %>% distinct(COUNTY,CN)
cfc <- county %>% inner_join(cf) %>% summarise(deaths=n())
counties <- map_data("county")
counties <- cfc %>% mutate(subregion=tolower(CN)) %>% inner_join(counties, by="subregion")
counties %>% ggplot(aes(x = long, y = lat)) +
geom_polygon(aes(group = group,fill=deaths)) +
coord_map()+scale_fill_continuous(low="thistle2", high="darkred",
guide="colorbar",na.value="white")
GLCs <- readxl::read_xlsx("FRPP_GLC_-_United_StatesNov42021.xlsx")
GLCs <- readxl::read_xlsx("GLC.xlsx")
states <- map_data('state')
GLCs$'State Name' <- tolower(GLCs$'State Name')
GLCs$'State Code' <- as.numeric(GLCs$'State Code')
labels <- states %>%
group_by(region) %>%
summarise(long= mean(long, na.rm = TRUE), lat= mean(lat, na.rm = TRUE))
labels <- left_join(labels, GLCs, by = c("region" = "State Name"))
labels <- left_join(labels, danger, by = c("State Code" = "STATE"))
labels$MAKE <- factor(labels$MAKE, levels = c(12, 20, 49, 37),
labels = c("Ford", "Chevrolet", "Toyota", "Honda"))
states %>% ggplot() +
geom_polygon( aes(x=long, y=lat, group=group),
color="grey", fill="blue" ) + geom_text(data=labels, aes(label =
MAKE, x=long, y=lat), color="black", size=3)
pacc <- person %>% inner_join(acc,by=c("STATE","COUNTY","DAY","MONTH","HOUR","MINUTE"))
pacc %>% group_by(DAY_WEEK) %>% summarise(num_accidents=n()) %>% mutate(day_of_week  = wday(DAY_WEEK, label = TRUE)) %>%
ggplot(aes(x=day_of_week,y=num_accidents)) + geom_bar(stat = "Identity")
pacc %>% group_by(HOUR) %>% filter(HOUR<25) %>% summarise(num_accidents=n()) %>%
ggplot(aes(x=HOUR,y=num_accidents)) + geom_bar(stat = "Identity")
paccF <- pacc %>%  filter(SEX<3)
paccF %>% mutate(sn = ifelse(paccF$SEX == 1, "male", "female")) %>% group_by(sn)  %>% summarise(num_accidents=n()) %>%
ggplot(aes(x=sn,y=num_accidents)) + geom_bar(stat = "Identity")
GLC <- GLC %>% rename(COUNTY="County Code")
df <- readxl::read_xlsx("GLC.xlsx")
states <- map_data('state')
counties <- map_data('county')
var <- c("STATE", "COUNTY", "FATALS")
fatals <- acc[var]
df$'State Code' <- as.numeric(df$`State Code`)
df$'City Code' <- as.numeric(df$`City Code`)
df$'County Code' <- as.numeric(df$`County Code`)
fatals <- fatals %>% group_by(STATE, COUNTY) %>%
summarize(FATALS = sum(FATALS))
fatals <- fatals %>% left_join(df, by=c('COUNTY' = 'County Code', 'STATE' =
'State Code'))
var2 <- c("State Name", "County Name", "FATALS")
fatals <- fatals[var2]
fatals <- unique(fatals)
fatals$`State Name` <- tolower(fatals$`State Name`)
fatals$`County Name` <- tolower(fatals$`County Name`)
fatals <- fatals %>% right_join(counties, by=c('County Name' = 'subregion',
'State Name' = 'region'))
ggplot(fatals, aes(x=long, y=lat)) +
geom_polygon(aes(group=group)) +
geom_polygon(aes(group=group, fill=FATALS))                   guide="colorbar",na.value="white")
df <- readxl::read_xlsx("GLC.xlsx")
states <- map_data('state')
counties <- map_data('county')
var <- c("STATE", "COUNTY", "FATALS")
fatals <- acc[var]
df$'State Code' <- as.numeric(df$`State Code`)
df$'City Code' <- as.numeric(df$`City Code`)
df$'County Code' <- as.numeric(df$`County Code`)
fatals <- fatals %>% group_by(STATE, COUNTY) %>%
summarize(FATALS = sum(FATALS))
fatals <- fatals %>% left_join(df, by=c('COUNTY' = 'County Code', 'STATE' =
'State Code'))
var2 <- c("State Name", "County Name", "FATALS")
fatals <- fatals[var2]
fatals <- unique(fatals)
fatals$`State Name` <- tolower(fatals$`State Name`)
fatals$`County Name` <- tolower(fatals$`County Name`)
fatals <- fatals %>% right_join(counties, by=c('County Name' = 'subregion',
'State Name' = 'region'))
ggplot(fatals, aes(x=long, y=lat)) +
geom_polygon(aes(group=group)) +
geom_polygon(aes(group=group, fill=FATALS))                   guide="colorbar",na.value="white")
df <- readxl::read_xlsx("GLC.xlsx")
states <- map_data('state')
counties <- map_data('county')
var <- c("STATE", "COUNTY", "FATALS")
fatals <- acc[var]
df$'State Code' <- as.numeric(df$`State Code`)
df$'City Code' <- as.numeric(df$`City Code`)
df$'County Code' <- as.numeric(df$`County Code`)
fatals <- fatals %>% group_by(STATE, COUNTY) %>%
summarize(FATALS = sum(FATALS))
fatals <- fatals %>% left_join(df, by=c('COUNTY' = 'County Code', 'STATE' =
'State Code'))
var2 <- c("State Name", "County Name", "FATALS")
fatals <- fatals[var2]
fatals <- unique(fatals)
fatals$`State Name` <- tolower(fatals$`State Name`)
fatals$`County Name` <- tolower(fatals$`County Name`)
fatals <- fatals %>% right_join(counties, by=c('County Name' = 'subregion',
'State Name' = 'region'))
ggplot(fatals, aes(x=long, y=lat)) +
geom_polygon(aes(group=group)) +
geom_polygon(aes(group=group, fill=FATALS))
Winter <- acc %>%
filter(MONTH < 5 | MONTH > 10)
Summer <- acc %>%
filter(MONTH > 5 & MONTH < 10)
var3 <- c("State Name", "State Code")
df2 <- df[var3]
df2 <- unique(df2)
winterFatal <- Winter %>%
group_by(STATE) %>%
summarize(FATALS = sum(FATALS))
summerFatal <- Summer %>%
group_by(STATE) %>%
summarize(FATALS = sum(FATALS))
summerFatal <- summerFatal %>% left_join(df2, by=c('STATE' = 'State Code'))
summerFatal$`State Name` <- tolower(summerFatal$`State Name`)
summerFatal <- summerFatal %>% right_join(states, by=c('State Name' = 'region'))
var2 <- c("STATE", "FATALS", "long", "lat", "group")
summerFatal <- summerFatal[var2]
ggplot(summerFatal, aes(x=long, y=lat, fill = FATALS)) +
geom_polygon(aes(group = group)) +
labs(title = "Car Accidents in the Summer by State")
winterFatal <- winterFatal %>% left_join(df2, by=c('STATE' = 'State Code'))
winterFatal$`State Name` <- tolower(winterFatal$`State Name`)
winterFatal <- winterFatal %>% right_join(states, by=c('State Name' = 'region'))
winterFatal <- winterFatal[var2]
ggplot(winterFatal, aes(x=long, y=lat, fill = FATALS)) +
geom_polygon(aes(group = group)) +
labs(title = "Car Accidents in the Winter by State")
GLC <- readxl::read_xlsx("GLC.xlsx")
states <- map_data('state')
GLCs$'State Name' <- tolower(GLCs$'State Name')
GLCs$'State Code' <- as.numeric(GLCs$'State Code')
labels <- states %>%
group_by(region) %>%
summarise(long= mean(long, na.rm = TRUE), lat= mean(lat, na.rm = TRUE))
labels <- left_join(labels, GLCs, by = c("region" = "State Name"))
labels <- left_join(labels, danger, by = c("State Code" = "STATE"))
labels$MAKE <- factor(labels$MAKE, levels = c(12, 20, 49, 37),
labels = c("Ford", "Chevrolet", "Toyota", "Honda"))
states %>% ggplot() +
geom_polygon( aes(x=long, y=lat, group=group),
color="grey", fill="blue" ) + geom_text(data=labels, aes(label =
MAKE, x=long, y=lat), color="black", size=3)
acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
person <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
